/*! For license information please see fbbe2ec4.dcae6f28.js.LICENSE.txt */
"use strict";(self.webpackChunkbackstage_microsite=self.webpackChunkbackstage_microsite||[]).push([[346240],{706557:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>c,contentTitle:()=>s,default:()=>h,frontMatter:()=>a,metadata:()=>r,toc:()=>l});var i=n(785893),o=n(511151);const a={id:"authentication",title:"Authentication",description:"How to set up authentication into your Backstage installation"},s=void 0,r={id:"getting-started/config/authentication",title:"Authentication",description:"How to set up authentication into your Backstage installation",source:"@site/../docs/getting-started/config/authentication.md",sourceDirName:"getting-started/config",slug:"/getting-started/config/authentication",permalink:"/docs/getting-started/config/authentication",draft:!1,unlisted:!1,editUrl:"https://github.com/backstage/backstage/edit/master/docs/../docs/getting-started/config/authentication.md",tags:[],version:"current",frontMatter:{id:"authentication",title:"Authentication",description:"How to set up authentication into your Backstage installation"},sidebar:"docs",previous:{title:"Database",permalink:"/docs/getting-started/config/database"},next:{title:"Configuring App with plugins",permalink:"/docs/getting-started/configure-app-with-plugins"}},c={},l=[{value:"Setting up authentication",id:"setting-up-authentication",level:3},{value:"Add sign-in option to the frontend",id:"add-sign-in-option-to-the-frontend",level:3},{value:"Setting up a GitHub Integration",id:"setting-up-a-github-integration",level:3}];function d(e){const t={a:"a",admonition:"admonition",code:"code",h3:"h3",img:"img",li:"li",p:"p",pre:"pre",ul:"ul",...(0,o.a)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(t.p,{children:"Audience: Admins or Developers"}),"\n",(0,i.jsx)(t.h3,{id:"setting-up-authentication",children:"Setting up authentication"}),"\n",(0,i.jsxs)(t.p,{children:["There are multiple authentication providers available for you to use with\nBackstage, feel free to follow\n",(0,i.jsx)(t.a,{href:"/docs/auth/",children:"the instructions for adding authentication"}),"."]}),"\n",(0,i.jsxs)(t.p,{children:["For this tutorial we choose to use GitHub, a free service most of you might be\nfamiliar with. For other options, see\n",(0,i.jsx)(t.a,{href:"/docs/auth/github/provider#create-an-oauth-app-on-github",children:"the auth provider documentation"}),"."]}),"\n",(0,i.jsxs)(t.p,{children:["Go to\n",(0,i.jsx)(t.a,{href:"https://github.com/settings/applications/new",children:"https://github.com/settings/applications/new"}),"\nto create your OAuth App. The ",(0,i.jsx)(t.code,{children:"Homepage URL"})," should point to Backstage's\nfrontend, in our tutorial it would be ",(0,i.jsx)(t.code,{children:"http://localhost:3000"}),". The\n",(0,i.jsx)(t.code,{children:"Authorization callback URL"})," will point to the auth backend, which will most\nlikely be ",(0,i.jsx)(t.code,{children:"http://localhost:7007/api/auth/github/handler/frame"}),"."]}),"\n",(0,i.jsx)(t.p,{children:(0,i.jsx)(t.img,{alt:"Screenshot of the GitHub OAuth creation page",src:n(952722).Z+"",width:"593",height:"554"})}),"\n",(0,i.jsxs)(t.p,{children:["Take note of the ",(0,i.jsx)(t.code,{children:"Client ID"})," and the ",(0,i.jsx)(t.code,{children:"Client Secret"}),". Open ",(0,i.jsx)(t.code,{children:"app-config.yaml"}),",\nand add your ",(0,i.jsx)(t.code,{children:"clientId"})," and ",(0,i.jsx)(t.code,{children:"clientSecret"})," to this file. It should end up\nlooking like this:"]}),"\n",(0,i.jsx)(t.pre,{children:(0,i.jsx)(t.code,{className:"language-yaml",metastring:'title="app-config.yaml"',children:"auth:\n  # see https://backstage.io/docs/auth/ to learn about auth providers\n  environment: development\n  providers:\n    github:\n      development:\n        clientId: YOUR CLIENT ID\n        clientSecret: YOUR CLIENT SECRET\n"})}),"\n",(0,i.jsx)(t.h3,{id:"add-sign-in-option-to-the-frontend",children:"Add sign-in option to the frontend"}),"\n",(0,i.jsx)(t.p,{children:"Backstage will re-read the configuration. If there's no errors, that's great! We\ncan continue with the last part of the configuration. The next step is needed to\nchange the sign-in page, this you actually need to add in the source code."}),"\n",(0,i.jsxs)(t.p,{children:["Open ",(0,i.jsx)(t.code,{children:"packages/app/src/App.tsx"})," and below the last ",(0,i.jsx)(t.code,{children:"import"})," line, add:"]}),"\n",(0,i.jsx)(t.pre,{children:(0,i.jsx)(t.code,{className:"language-typescript",metastring:'title="packages/app/src/App.tsx"',children:"import { githubAuthApiRef } from '@backstage/core-plugin-api';\n"})}),"\n",(0,i.jsxs)(t.p,{children:["Search for ",(0,i.jsx)(t.code,{children:"const app = createApp({"})," in this file, and below ",(0,i.jsx)(t.code,{children:"apis,"})," add:"]}),"\n",(0,i.jsx)(t.pre,{children:(0,i.jsx)(t.code,{className:"language-tsx",metastring:'title="packages/app/src/App.tsx"',children:"components: {\n  SignInPage: props => (\n    <SignInPage\n      {...props}\n      auto\n      provider={{\n        id: 'github-auth-provider',\n        title: 'GitHub',\n        message: 'Sign in using GitHub',\n        apiRef: githubAuthApiRef,\n      }}\n    />\n  ),\n},\n"})}),"\n",(0,i.jsx)(t.admonition,{title:"Note",type:"note",children:(0,i.jsxs)(t.p,{children:['The default Backstage app comes with a guest Sign In Resolver. This resolver makes all users share a single "guest" identity and is only intended as a minimum requirement to quickly get up and running. You can read more about how ',(0,i.jsx)(t.a,{href:"/docs/auth/identity-resolver#sign-in-resolvers",children:"Sign In Resolvers"})," play a role in creating a ",(0,i.jsx)(t.a,{href:"/docs/auth/identity-resolver#backstage-user-identity",children:"Backstage User Identity"})," for logged in users."]})}),"\n",(0,i.jsxs)(t.p,{children:["Restart Backstage from the terminal, by stopping it with ",(0,i.jsx)(t.code,{children:"Control-C"}),", and starting it with ",(0,i.jsx)(t.code,{children:"yarn dev"})," . You should be welcomed by a login prompt!"]}),"\n",(0,i.jsx)(t.admonition,{title:"Note",type:"note",children:(0,i.jsx)(t.p,{children:"Sometimes the frontend starts before the backend resulting in errors on the sign in page. Wait for the backend to start and then reload Backstage to proceed."})}),"\n",(0,i.jsx)(t.p,{children:"To learn more about Authentication in Backstage, here are some docs you\ncould read:"}),"\n",(0,i.jsxs)(t.ul,{children:["\n",(0,i.jsx)(t.li,{children:(0,i.jsx)(t.a,{href:"/docs/auth/",children:"Authentication in Backstage"})}),"\n",(0,i.jsx)(t.li,{children:(0,i.jsx)(t.a,{href:"/docs/integrations/github/org",children:"Using organizational data from GitHub"})}),"\n"]}),"\n",(0,i.jsx)(t.h3,{id:"setting-up-a-github-integration",children:"Setting up a GitHub Integration"}),"\n",(0,i.jsxs)(t.p,{children:["The GitHub integration supports loading catalog entities from GitHub or GitHub\nEnterprise. Entities can be added to static catalog configuration, registered\nwith the catalog-import plugin, or discovered from a GitHub organization. Users\nand Groups can also be loaded from an organization. While using ",(0,i.jsx)(t.a,{href:"/docs/integrations/github/github-apps",children:"GitHub Apps"}),"\nmight be the best way to set up integrations, for this tutorial you'll use a\nPersonal Access Token."]}),"\n",(0,i.jsxs)(t.p,{children:["Create your Personal Access Token by opening\n",(0,i.jsx)(t.a,{href:"https://github.com/settings/tokens/new",children:"the GitHub token creation page"}),". Use a\nname to identify this token and put it in the notes field. Choose a number of\ndays for expiration. If you have a hard time picking a number, we suggest to go\nfor 7 days, it's a lucky number."]}),"\n",(0,i.jsx)(t.p,{children:(0,i.jsx)(t.img,{alt:"Screenshot of the GitHub Personal Access Token creation page",src:n(474296).Z+"",width:"784",height:"298"})}),"\n",(0,i.jsxs)(t.p,{children:["Set the scope to your likings. For this tutorial, selecting ",(0,i.jsx)(t.code,{children:"repo"})," and ",(0,i.jsx)(t.code,{children:"workflow"})," is required as the scaffolding job in this guide configures a GitHub actions workflow for the newly created project."]}),"\n",(0,i.jsxs)(t.p,{children:["For this tutorial, we will be writing the token to ",(0,i.jsx)(t.code,{children:"app-config.local.yaml"}),". This file might not exist for you, so if it doesn't go ahead and create it alongside the ",(0,i.jsx)(t.code,{children:"app-config.yaml"})," at the root of the project.\nThis file should also be excluded in ",(0,i.jsx)(t.code,{children:".gitignore"}),", to avoid accidental committing of this file."]}),"\n",(0,i.jsxs)(t.p,{children:["In your ",(0,i.jsx)(t.code,{children:"app-config.local.yaml"})," go ahead and add the following:"]}),"\n",(0,i.jsx)(t.pre,{children:(0,i.jsx)(t.code,{className:"language-yaml",metastring:'title="app-config.local.yaml"',children:"integrations:\n  github:\n    - host: github.com\n      token: ghp_urtokendeinfewinfiwebfweb # this should be the token from GitHub\n"})}),"\n",(0,i.jsx)(t.p,{children:"That's settled. This information will be leveraged by other plugins."}),"\n",(0,i.jsxs)(t.p,{children:["If you're looking for a more production way to manage this secret, then you can do the following with the token being stored in an environment variable called ",(0,i.jsx)(t.code,{children:"GITHUB_TOKEN"}),"."]}),"\n",(0,i.jsx)(t.pre,{children:(0,i.jsx)(t.code,{className:"language-yaml",metastring:'title="app-config.local.yaml"',children:"integrations:\n  github:\n    - host: github.com\n      token: ${GITHUB_TOKEN} # this will use the environment variable GITHUB_TOKEN\n"})}),"\n",(0,i.jsx)(t.admonition,{title:"Note",type:"note",children:(0,i.jsxs)(t.p,{children:["If you've updated the configuration for your integration, it's likely that the backend will need a restart to apply these changes. To do this, stop the running instance in your terminal with ",(0,i.jsx)(t.code,{children:"Control-C"}),", then start it again with ",(0,i.jsx)(t.code,{children:"yarn dev"}),". Once the backend has restarted, retry the operation."]})}),"\n",(0,i.jsx)(t.p,{children:"Some helpful links, for if you want to learn more about:"}),"\n",(0,i.jsxs)(t.ul,{children:["\n",(0,i.jsx)(t.li,{children:(0,i.jsx)(t.a,{href:"/docs/integrations/",children:"Other available integrations"})}),"\n",(0,i.jsx)(t.li,{children:(0,i.jsx)(t.a,{href:"/docs/integrations/github/github-apps#docsNav",children:"Using GitHub Apps instead of a Personal Access Token"})}),"\n"]})]})}function h(e={}){const{wrapper:t}={...(0,o.a)(),...e.components};return t?(0,i.jsx)(t,{...e,children:(0,i.jsx)(d,{...e})}):d(e)}},675251:(e,t,n)=>{var i=n(667294),o=Symbol.for("react.element"),a=Symbol.for("react.fragment"),s=Object.prototype.hasOwnProperty,r=i.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,c={key:!0,ref:!0,__self:!0,__source:!0};function l(e,t,n){var i,a={},l=null,d=null;for(i in void 0!==n&&(l=""+n),void 0!==t.key&&(l=""+t.key),void 0!==t.ref&&(d=t.ref),t)s.call(t,i)&&!c.hasOwnProperty(i)&&(a[i]=t[i]);if(e&&e.defaultProps)for(i in t=e.defaultProps)void 0===a[i]&&(a[i]=t[i]);return{$$typeof:o,type:e,key:l,ref:d,props:a,_owner:r.current}}t.Fragment=a,t.jsx=l,t.jsxs=l},785893:(e,t,n)=>{e.exports=n(675251)},952722:(e,t,n)=>{n.d(t,{Z:()=>i});const i=n.p+"assets/images/gh-oauth-6ba1157307d9e1a95301a49e9ee1b05b.png"},474296:(e,t,n)=>{n.d(t,{Z:()=>i});const i=n.p+"assets/images/gh-pat-b09e0abf61ff86557a8a986951584879.png"},511151:(e,t,n)=>{n.d(t,{Z:()=>r,a:()=>s});var i=n(667294);const o={},a=i.createContext(o);function s(e){const t=i.useContext(a);return i.useMemo((function(){return"function"==typeof e?e(t):{...t,...e}}),[t,e])}function r(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(o):e.components||o:s(e.components),i.createElement(a.Provider,{value:t},e.children)}}}]);